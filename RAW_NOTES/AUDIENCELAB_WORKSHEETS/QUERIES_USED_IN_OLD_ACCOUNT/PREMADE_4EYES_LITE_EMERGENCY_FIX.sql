

// 1) Empty data from PREMADE_4EYES_LITE, to renew its data
// TRUNCATE TABLE FOUR_EYES.PUBLIC.PREMADE_4EYES_LITE





// 2) Fill PREMADE_4EYES_LITE with data from the past 5 days, extracted from PREMADE_4EYES table:
//INSERT INTO FOUR_EYES.PUBLIC.PREMADE_4EYES_LITE
//SELECT * FROM FOUR_EYES.PUBLIC.PREMADE_4EYES
//WHERE DATE IN ('2024-02-11', '2024-02-12', '2024-02-13', '2024-02-14', '2024-02-15', '2024-02-16');


// 3) Validate PREMADE_4EYES_LITE (12 days of data):
SELECT * FROM FOUR_EYES.PUBLIC.PREMADE_4EYES_LITE
WHERE DATE IN ('2024-02-11') LIMIT 1000;

SELECT * FROM FOUR_EYES.PUBLIC.PREMADE_4EYES_LITE
WHERE DATE IN ('2024-02-12') LIMIT 1000;

SELECT * FROM FOUR_EYES.PUBLIC.PREMADE_4EYES_LITE
WHERE DATE IN ('2024-02-13') LIMIT 1000;

SELECT * FROM FOUR_EYES.PUBLIC.PREMADE_4EYES_LITE
WHERE DATE IN ('2024-02-14') LIMIT 1000;

SELECT * FROM FOUR_EYES.PUBLIC.PREMADE_4EYES_LITE
WHERE DATE IN ('2024-02-15') LIMIT 1000;

SELECT * FROM FOUR_EYES.PUBLIC.PREMADE_4EYES_LITE
WHERE DATE IN ('2024-02-16') LIMIT 1000;

SELECT * FROM FOUR_EYES.PUBLIC.PREMADE_4EYES_LITE
WHERE DATE IN ('2024-02-17') LIMIT 1000;

SELECT * FROM FOUR_EYES.PUBLIC.PREMADE_4EYES_LITE
WHERE DATE IN ('2024-02-18') LIMIT 1000;

SELECT * FROM FOUR_EYES.PUBLIC.PREMADE_4EYES_LITE
WHERE DATE IN ('2024-02-19') LIMIT 1000;

SELECT * FROM FOUR_EYES.PUBLIC.PREMADE_4EYES_LITE
WHERE DATE IN ('2024-02-20') LIMIT 1000;

SELECT * FROM FOUR_EYES.PUBLIC.PREMADE_4EYES_LITE
WHERE DATE IN ('2024-02-21') LIMIT 1000;

SELECT * FROM FOUR_EYES.PUBLIC.PREMADE_4EYES_LITE
WHERE DATE IN ('2024-02-22') LIMIT 1000;

SELECT * FROM FOUR_EYES.PUBLIC.PREMADE_4EYES_LITE
WHERE DATE IN ('2024-02-23') LIMIT 1000;

SELECT * FROM FOUR_EYES.PUBLIC.PREMADE_4EYES_LITE
WHERE DATE IN ('2024-02-24') LIMIT 1000;

SELECT * FROM FOUR_EYES.PUBLIC.PREMADE_4EYES_LITE
WHERE DATE IN ('2024-02-25') LIMIT 1000;

SELECT * FROM FOUR_EYES.PUBLIC.PREMADE_4EYES_LITE
WHERE DATE IN ('2024-02-26') LIMIT 1000;

SELECT * FROM FOUR_EYES.PUBLIC.PREMADE_4EYES_LITE
WHERE DATE IN ('2024-02-27') LIMIT 1000;

SELECT * FROM FOUR_EYES.PUBLIC.PREMADE_4EYES_LITE
WHERE DATE IN ('2024-02-28') LIMIT 1000;

SELECT * FROM FOUR_EYES.PUBLIC.PREMADE_4EYES_LITE
WHERE DATE IN ('2024-02-29') LIMIT 1000;

SELECT * FROM FOUR_EYES.PUBLIC.PREMADE_4EYES_LITE
WHERE DATE IN ('2024-03-01') LIMIT 1000;

SELECT * FROM FOUR_EYES.PUBLIC.PREMADE_4EYES_LITE
WHERE DATE IN ('2024-03-02') LIMIT 1000;

SELECT * FROM FOUR_EYES.PUBLIC.PREMADE_4EYES_LITE
WHERE DATE IN ('2024-03-03') LIMIT 1000;

SELECT * FROM FOUR_EYES.PUBLIC.PREMADE_4EYES_LITE
WHERE DATE IN ('2024-03-04') LIMIT 1000;

SELECT * FROM FOUR_EYES.PUBLIC.PREMADE_4EYES_LITE
WHERE DATE IN ('2024-03-05') LIMIT 1000;

SELECT * FROM FOUR_EYES.PUBLIC.PREMADE_4EYES_LITE
WHERE DATE IN ('2024-03-06') LIMIT 1000;

SELECT * FROM FOUR_EYES.PUBLIC.PREMADE_4EYES_LITE
WHERE DATE IN ('2024-03-07') LIMIT 1000;

SELECT * FROM FOUR_EYES.PUBLIC.PREMADE_4EYES_LITE
WHERE DATE IN ('2024-03-08') LIMIT 1000;

SELECT * FROM FOUR_EYES.PUBLIC.PREMADE_4EYES_LITE
WHERE DATE IN ('2024-03-09') LIMIT 1000;

SELECT * FROM FOUR_EYES.PUBLIC.PREMADE_4EYES_LITE
WHERE DATE IN ('2024-03-10') LIMIT 1000;

SELECT * FROM FOUR_EYES.PUBLIC.PREMADE_4EYES_LITE
WHERE DATE IN ('2024-03-11') LIMIT 1000;

SELECT * FROM FOUR_EYES.PUBLIC.PREMADE_4EYES_LITE
WHERE DATE IN ('2024-03-12') LIMIT 1000;

SELECT * FROM FOUR_EYES.PUBLIC.PREMADE_4EYES_LITE
WHERE DATE IN ('2024-03-13') LIMIT 1000;

SELECT * FROM FOUR_EYES.PUBLIC.PREMADE_4EYES_LITE
WHERE DATE IN ('2024-03-14') LIMIT 1000;

SELECT * FROM FOUR_EYES.PUBLIC.PREMADE_4EYES_LITE
WHERE DATE IN ('2024-03-15') LIMIT 1000;

SELECT * FROM FOUR_EYES.PUBLIC.PREMADE_4EYES_LITE
WHERE DATE IN ('2024-03-16') LIMIT 1000;

SELECT * FROM FOUR_EYES.PUBLIC.PREMADE_4EYES_LITE
WHERE DATE IN ('2024-03-17') LIMIT 1000;


SELECT * FROM FOUR_EYES.PUBLIC.PREMADE_4EYES_LITE
WHERE DATE IN ('2024-03-19') LIMIT 1000;

SELECT * FROM FOUR_EYES.PUBLIC.PREMADE_4EYES_LITE
WHERE DATE IN ('2024-03-20') LIMIT 1000;

SELECT * FROM FOUR_EYES.PUBLIC.PREMADE_4EYES_LITE
WHERE DATE IN ('2024-03-21') LIMIT 1000;

SELECT * FROM FOUR_EYES.PUBLIC.PREMADE_4EYES_LITE
WHERE DATE IN ('2024-03-22') LIMIT 1000;

SELECT * FROM FOUR_EYES.PUBLIC.PREMADE_4EYES_LITE
WHERE DATE IN ('2024-03-23') LIMIT 1000;

SELECT * FROM FOUR_EYES.PUBLIC.PREMADE_4EYES_LITE
WHERE DATE IN ('2024-03-24') LIMIT 1000;

SELECT * FROM FOUR_EYES.PUBLIC.PREMADE_4EYES_LITE
WHERE DATE IN ('2024-03-25') LIMIT 1000;

SELECT * FROM FOUR_EYES.PUBLIC.PREMADE_4EYES_LITE
WHERE DATE IN ('2024-04-07') LIMIT 1000;



4eyes_117790


SELECT COUNT(*) FROM FOUR_EYES.PUBLIC.PREMADE_4EYES_LITE
WHERE SEGMENT IN ('4eyes_102893','4eyes_108584','4eyes_108612','4eyes_108676','4eyes_108844','4eyes_108865','4eyes_108890','4eyes_108897','4eyes_108948','4eyes_108967','4eyes_108981','4eyes_109002','4eyes_109012','4eyes_109027','4eyes_109031','4eyes_109049','4eyes_109056','4eyes_109116','4eyes_109247','4eyes_109304','4eyes_109373','4eyes_109378','4eyes_109501','4eyes_109732','4eyes_109773','4eyes_109904','4eyes_110009','4eyes_110035','4eyes_110158','4eyes_110194','4eyes_110226','4eyes_110405','4eyes_110432','4eyes_110443','4eyes_110456','4eyes_110481','4eyes_110664','4eyes_110792','4eyes_111033','4eyes_111107','4eyes_111360','4eyes_111377','4eyes_111411','4eyes_111437','4eyes_111452','4eyes_111474','4eyes_111477','4eyes_111479','4eyes_111501','4eyes_111513','4eyes_111521','4eyes_111582','4eyes_111587','4eyes_111601','4eyes_111606','4eyes_111616','4eyes_111624','4eyes_111630','4eyes_111639','4eyes_111657','4eyes_111729','4eyes_111761','4eyes_111779','4eyes_111949','4eyes_112126','4eyes_112138','4eyes_112352','4eyes_112395','4eyes_112401','4eyes_112403','4eyes_112418','4eyes_112428','4eyes_112447','4eyes_112466','4eyes_112535','4eyes_112555','4eyes_112566','4eyes_112621','4eyes_112674','4eyes_112685','4eyes_112720','4eyes_112762','4eyes_112763','4eyes_112819','4eyes_112975','4eyes_119760','4eyes_121598','4eyes_121656','4eyes_121675','4eyes_121695','4eyes_121710','4eyes_121729','4eyes_116932','4eyes_117771','4eyes_117773','4eyes_117790','4eyes_117807','4eyes_117819','4eyes_117821','4eyes_117830','4eyes_117837','4eyes_117839','4eyes_117844','4eyes_117872','4eyes_117915','4eyes_117922','4eyes_117925','4eyes_117928','4eyes_117936','4eyes_117943','4eyes_117952','4eyes_117953','4eyes_118009','4eyes_118038','4eyes_118121','4eyes_118125','4eyes_118228','4eyes_118252','4eyes_118290','4eyes_118291','4eyes_118292','4eyes_118333','4eyes_118352','4eyes_118376','4eyes_118378','4eyes_118381','4eyes_118405','4eyes_118407','4eyes_118461','4eyes_118523','4eyes_118548','4eyes_118659','4eyes_118665','4eyes_118670','4eyes_113053','4eyes_113147','4eyes_113229','4eyes_113280','4eyes_113289','4eyes_113340','4eyes_113381','4eyes_113388','4eyes_113421','4eyes_113435','4eyes_113508','4eyes_113569','4eyes_113619','4eyes_113636','4eyes_113678','4eyes_113700','4eyes_113726','4eyes_113922','4eyes_113964','4eyes_115197','4eyes_115246','4eyes_105204','4eyes_105424','4eyes_105436','4eyes_105521','4eyes_105730','4eyes_105756','4eyes_105810','4eyes_105904','4eyes_105944','4eyes_106016')  AND date >= '2024-04-03' AND date <= '2024-04-07';




// 179.467.323 rows


SELECT * FROM TABLE(FOUR_EYES.INFORMATION_SCHEMA.TASK_HISTORY())
ORDER BY SCHEDULED_TIME DESC;




// task will be executed at 21:43pm, GMT-3





SELECT * FROM FOUR_EYES.PUBLIC.PREMADE_4EYES WHERE DATE IN ('2024-02-15') LIMIT 100;




SELECT * FROM FOUR_EYES.PUBLIC.PREMADE_4EYES_LITE WHERE DATE IN ('2024-02-15') LIMIT 100;





// *********
// Column organization changed completely, "TOPIC" column, which was the SECOND column, now is THIRD column. Second column now is UP_ID.
       SELECT 
        T.$1 AS "SHA256_LC_HEM",
        T.$3 AS "TOPIC",   // this changed; it was "$2" before. "$2", now, is UP_ID
        TO_DATE(SUBSTR(METADATA$FILENAME, 10, 8), 'YYYYMMDD') AS DATE  -- Get the DATE Value
        FROM @FOUR_EYES.PUBLIC.FOUR_EYES_STAGE_CSV/dt=20240218/part-00000-2d51c1d2-0926-401f-9ec9-32e9ab6182c4-c000.csv.gz T LIMIT 100;







-------------- To Solve Everything: ----------------




-- 1) Delete data of invalid dates (16 - 18)
DELETE FROM FOUR_EYES.PUBLIC.PREMADE_4EYES_LITE
WHERE DATE IN ('2024-02-16', '2024-02-17', '2024-02-18');



// Done
-- 2) Re-Create CSV pipe, now with correct order, so that new raw_topics rows always get correct data:
//CREATE OR REPLACE PIPE FOUR_EYES.PUBLIC.CSV_PIPE
//    AUTO_INGEST=TRUE
 //   AS 
 //   COPY INTO FOUR_EYES.PUBLIC.RAW_TOPICS
//    FROM (
//        SELECT 
//        T.$1 AS "SHA256_LC_HEM",
//        T.$3 AS "TOPIC", -- changed, before it was T.$2
//        TO_DATE(SUBSTR(METADATA$FILENAME, 10, 8), 'YYYYMMDD') AS DATE  -- Get the DATE Value
 //       FROM @FOUR_EYES.PUBLIC.FOUR_EYES_STAGE_CSV AS T
//    );




-- 3) Delete invalid RAW_TOPICS data in RAW_TOPICS table:
//SELECT * FROM FOUR_EYES.PUBLIC.RAW_TOPICS WHERE DATE IN ('2024-02-16', '2024-02-17', '2024-02-18') LIMIT 100;

DELETE FROM FOUR_EYES.PUBLIC.RAW_TOPICS
WHERE DATE IN ('2024-02-16', '2024-02-17', '2024-02-18');



SELECT * FROM FOUR_EYES.PUBLIC.RAW_TOPICS
WHERE DATE='2024-02-15' LIMIT 1000;


SELECT * FROM FOUR_EYES.PUBLIC.RAW_TOPICS
WHERE DATE='2024-02-16' LIMIT 1000;

SELECT * FROM FOUR_EYES.PUBLIC.RAW_TOPICS
WHERE DATE='2024-02-17' LIMIT 1000;

SELECT * FROM FOUR_EYES.PUBLIC.RAW_TOPICS
WHERE DATE='2024-02-18' LIMIT 1000;


-- 4) Copy Valid RAW_TOPICS data from 16-18, into RAW_TOPICS table:

    // day 16
    COPY INTO FOUR_EYES.PUBLIC.RAW_TOPICS
    FROM (
        SELECT 
        T.$1 AS "SHA256_LC_HEM",
        T.$3 AS "TOPIC", -- changed, before it was T.$2
        TO_DATE(SUBSTR(METADATA$FILENAME, 10, 8), 'YYYYMMDD') AS DATE  -- Get the DATE Value
        FROM @FOUR_EYES.PUBLIC.FOUR_EYES_STAGE_CSV/dt=20240216/ AS T
    );


-- 4.1)

    // day 17
    COPY INTO FOUR_EYES.PUBLIC.RAW_TOPICS
    FROM (
        SELECT 
        T.$1 AS "SHA256_LC_HEM",
        T.$3 AS "TOPIC", -- changed, before it was T.$2
        TO_DATE(SUBSTR(METADATA$FILENAME, 10, 8), 'YYYYMMDD') AS DATE  -- Get the DATE Value
        FROM @FOUR_EYES.PUBLIC.FOUR_EYES_STAGE_CSV/dt=20240217/ AS T
    );

-- 4.2) 

    // day 18
    COPY INTO FOUR_EYES.PUBLIC.RAW_TOPICS
    FROM (
        SELECT 
        T.$1 AS "SHA256_LC_HEM",
        T.$3 AS "TOPIC", -- changed, before it was T.$2
        TO_DATE(SUBSTR(METADATA$FILENAME, 10, 8), 'YYYYMMDD') AS DATE  -- Get the DATE Value
        FROM @FOUR_EYES.PUBLIC.FOUR_EYES_STAGE_CSV/dt=20240218/ AS T
    );


-- 5) Insert new, correct, joined data between SHA_TO_UPS and RAW_TOPICS (now valid), for the days of 16, 17 and 18

    INSERT INTO FOUR_EYES.PUBLIC.PREMADE_4EYES_LITE
    WITH STU AS (
      SELECT "UP_IDS" AS IDS FROM FOUR_EYES.PUBLIC.SHA_TO_UPS
    )
    SELECT
      RT.DATE AS "DATE",
      RT.TOPIC AS "SEGMENT",
      F.value::string AS up_id
    FROM
      "FOUR_EYES"."PUBLIC"."RAW_TOPICS" AS RT
    INNER JOIN
      "FOUR_EYES"."PUBLIC"."SHA_TO_UPS" AS SHA_TO_UPS
      ON SHA_TO_UPS."SHA256_LC_HEM" = RT."SHA256_LC_HEM"
      AND RT.DATE IN ('2024-02-16', '2024-02-17', '2024-02-18')
    CROSS JOIN
   LATERAL FLATTEN(input => SHA_TO_UPS.UP_IDS) F;





// 6) PREMADE_4EYES_TASK is no longer needed, as the .csvs now have different column configurations, and table creation will always be wrong:
    ALTER TASK FOUR_EYES.PUBLIC.PREMADE_4EYES_TASK SUSPEND;

















SELECT * FROM AUDIENCELAB_INTERNAL_PROD.PUBLIC.UNIVERSAL_PERSON WHERE UP_ID IN (SELECT consumer.up_id FROM four_eyes.public.premade_4eyes_lite pa INNER JOIN AUDIENCELAB_INTERNAL_PROD.PUBLIC.CONSUMER_B2C_FULL consumer ON pa.up_id=consumer.up_id WHERE consumer.id IS NOT NULL AND SEGMENT IN ('4eyes_108584','4eyes_108612','4eyes_108676','4eyes_108844','4eyes_108865','4eyes_108890','4eyes_108897','4eyes_108948','4eyes_108967','4eyes_108981','4eyes_109002','4eyes_109012','4eyes_109027','4eyes_109031','4eyes_109049','4eyes_109056','4eyes_109116','4eyes_109247','4eyes_109304','4eyes_109373','4eyes_109378','4eyes_109501','4eyes_109732','4eyes_109773','4eyes_109904','4eyes_110009','4eyes_110035','4eyes_110158','4eyes_110194','4eyes_110226','4eyes_110405','4eyes_110432','4eyes_110443','4eyes_110456','4eyes_110481','4eyes_110664','4eyes_110792','4eyes_111033','4eyes_111107','4eyes_111360','4eyes_111377','4eyes_111411','4eyes_111437','4eyes_111452','4eyes_111474','4eyes_111477','4eyes_111479','4eyes_111501','4eyes_111513','4eyes_111521','4eyes_111582','4eyes_111587','4eyes_111601','4eyes_111606','4eyes_111616','4eyes_111624','4eyes_111630','4eyes_111639','4eyes_111657','4eyes_111729','4eyes_111761','4eyes_111779','4eyes_111949','4eyes_112126','4eyes_112138','4eyes_112352','4eyes_112395','4eyes_112401','4eyes_112403','4eyes_112418','4eyes_112428','4eyes_112447','4eyes_112466','4eyes_112535','4eyes_112555','4eyes_112566','4eyes_112621','4eyes_112674','4eyes_112685','4eyes_112720','4eyes_112762','4eyes_112763','4eyes_112819','4eyes_112975','4eyes_119760','4eyes_121598','4eyes_121656','4eyes_121675','4eyes_121695','4eyes_121710','4eyes_121729','4eyes_116932','4eyes_117771','4eyes_117773','4eyes_117790','4eyes_117807','4eyes_117819','4eyes_117821','4eyes_117830','4eyes_117837','4eyes_117839','4eyes_117844','4eyes_117872','4eyes_117915','4eyes_117922','4eyes_117925','4eyes_117928','4eyes_117936','4eyes_117943','4eyes_117952','4eyes_117953','4eyes_118009','4eyes_118038','4eyes_118121','4eyes_118125','4eyes_118228','4eyes_118252','4eyes_118290','4eyes_118291','4eyes_118292','4eyes_118333','4eyes_118352','4eyes_118376','4eyes_118378','4eyes_118381','4eyes_118405','4eyes_118407','4eyes_118461','4eyes_118523','4eyes_118548','4eyes_118659','4eyes_118665','4eyes_118670','4eyes_113053','4eyes_113147','4eyes_113229','4eyes_113280','4eyes_113289','4eyes_113340','4eyes_113381','4eyes_113388','4eyes_113421','4eyes_113435','4eyes_113508','4eyes_113569','4eyes_113619','4eyes_113636','4eyes_113678','4eyes_113700','4eyes_113726','4eyes_113922','4eyes_113964','4eyes_115197','4eyes_115246','4eyes_105204','4eyes_105424','4eyes_105436','4eyes_105521','4eyes_105730','4eyes_105756','4eyes_105810','4eyes_105904','4eyes_105944','4eyes_106016','4eyes_102337')  AND date BETWEEN '2024-03-01' AND date <= '2024-03-08' LIMIT 100000 OFFSET 400000);



    


SELECT * FROM AUDIENCELAB_INTERNAL_PROD.PUBLIC.UNIVERSAL_PERSON WHERE UP_ID IN (SELECT consumer.up_id FROM four_eyes.public.premade_4eyes_lite pa INNER JOIN AUDIENCELAB_INTERNAL_PROD.PUBLIC.CONSUMER_B2C_FULL consumer ON pa.up_id=consumer.up_id WHERE consumer.id IS NOT NULL AND SEGMENT IN ('4eyes_108584','4eyes_108612','4eyes_108676','4eyes_108844','4eyes_108865','4eyes_108890','4eyes_108897','4eyes_108948','4eyes_108967','4eyes_108981','4eyes_109002','4eyes_109012','4eyes_109027','4eyes_109031','4eyes_109049','4eyes_109056','4eyes_109116','4eyes_109247','4eyes_109304','4eyes_109373','4eyes_109378','4eyes_109501','4eyes_109732','4eyes_109773','4eyes_109904','4eyes_110009','4eyes_110035','4eyes_110158','4eyes_110194','4eyes_110226','4eyes_110405','4eyes_110432','4eyes_110443','4eyes_110456','4eyes_110481','4eyes_110664','4eyes_110792','4eyes_111033','4eyes_111107','4eyes_111360','4eyes_111377','4eyes_111411','4eyes_111437','4eyes_111452','4eyes_111474','4eyes_111477','4eyes_111479','4eyes_111501','4eyes_111513','4eyes_111521','4eyes_111582','4eyes_111587','4eyes_111601','4eyes_111606','4eyes_111616','4eyes_111624','4eyes_111630','4eyes_111639','4eyes_111657','4eyes_111729','4eyes_111761','4eyes_111779','4eyes_111949','4eyes_112126','4eyes_112138','4eyes_112352','4eyes_112395','4eyes_112401','4eyes_112403','4eyes_112418','4eyes_112428','4eyes_112447','4eyes_112466','4eyes_112535','4eyes_112555','4eyes_112566','4eyes_112621','4eyes_112674','4eyes_112685','4eyes_112720','4eyes_112762','4eyes_112763','4eyes_112819','4eyes_112975','4eyes_119760','4eyes_121598','4eyes_121656','4eyes_121675','4eyes_121695','4eyes_121710','4eyes_121729','4eyes_116932','4eyes_117771','4eyes_117773','4eyes_117790','4eyes_117807','4eyes_117819','4eyes_117821','4eyes_117830','4eyes_117837','4eyes_117839','4eyes_117844','4eyes_117872','4eyes_117915','4eyes_117922','4eyes_117925','4eyes_117928','4eyes_117936','4eyes_117943','4eyes_117952','4eyes_117953','4eyes_118009','4eyes_118038','4eyes_118121','4eyes_118125','4eyes_118228','4eyes_118252','4eyes_118290','4eyes_118291','4eyes_118292','4eyes_118333','4eyes_118352','4eyes_118376','4eyes_118378','4eyes_118381','4eyes_118405','4eyes_118407','4eyes_118461','4eyes_118523','4eyes_118548','4eyes_118659','4eyes_118665','4eyes_118670','4eyes_113053','4eyes_113147','4eyes_113229','4eyes_113280','4eyes_113289','4eyes_113340','4eyes_113381','4eyes_113388','4eyes_113421','4eyes_113435','4eyes_113508','4eyes_113569','4eyes_113619','4eyes_113636','4eyes_113678','4eyes_113700','4eyes_113726','4eyes_113922','4eyes_113964','4eyes_115197','4eyes_115246','4eyes_105204','4eyes_105424','4eyes_105436','4eyes_105521','4eyes_105730','4eyes_105756','4eyes_105810','4eyes_105904','4eyes_105944','4eyes_106016')  AND date >= '2024-04-01' AND date <= '2024-04-08' LIMIT 200000);








SELECT * FROM AUDIENCELAB_INTERNAL_PROD.PUBLIC.UNIVERSAL_PERSON WHERE UP_ID IN (SELECT consumer.up_id FROM four_eyes.public.premade_4eyes_lite pa INNER JOIN AUDIENCELAB_INTERNAL_PROD.PUBLIC.CONSUMER_B2C_FULL consumer ON pa.up_id=consumer.up_id WHERE consumer.id IS NOT NULL AND SEGMENT IN ('4eyes_108584','4eyes_108612','4eyes_108676','4eyes_108844','4eyes_108865','4eyes_108890','4eyes_108897','4eyes_108948','4eyes_108967','4eyes_108981','4eyes_109002','4eyes_109012','4eyes_109027','4eyes_109031','4eyes_109049','4eyes_109056','4eyes_109116','4eyes_109247','4eyes_109304','4eyes_109373','4eyes_109378','4eyes_109501','4eyes_109732','4eyes_109773','4eyes_109904','4eyes_110009','4eyes_110035','4eyes_110158','4eyes_110194','4eyes_110226','4eyes_110405','4eyes_110432','4eyes_110443','4eyes_110456','4eyes_110481','4eyes_110664','4eyes_110792','4eyes_111033','4eyes_111107','4eyes_111360','4eyes_111377','4eyes_111411','4eyes_111437','4eyes_111452','4eyes_111474','4eyes_111477','4eyes_111479','4eyes_111501','4eyes_111513','4eyes_111521','4eyes_111582','4eyes_111587','4eyes_111601','4eyes_111606','4eyes_111616','4eyes_111624','4eyes_111630','4eyes_111639','4eyes_111657','4eyes_111729','4eyes_111761','4eyes_111779','4eyes_111949','4eyes_112126','4eyes_112138','4eyes_112352','4eyes_112395','4eyes_112401','4eyes_112403','4eyes_112418','4eyes_112428','4eyes_112447','4eyes_112466','4eyes_112535','4eyes_112555','4eyes_112566','4eyes_112621','4eyes_112674','4eyes_112685','4eyes_112720','4eyes_112762','4eyes_112763','4eyes_112819','4eyes_112975','4eyes_119760','4eyes_121598','4eyes_121656','4eyes_121675','4eyes_121695','4eyes_121710','4eyes_121729','4eyes_116932','4eyes_117771','4eyes_117773','4eyes_117790','4eyes_117807','4eyes_117819','4eyes_117821','4eyes_117830','4eyes_117837','4eyes_117839','4eyes_117844','4eyes_117872','4eyes_117915','4eyes_117922','4eyes_117925','4eyes_117928','4eyes_117936','4eyes_117943','4eyes_117952','4eyes_117953','4eyes_118009','4eyes_118038','4eyes_118121','4eyes_118125','4eyes_118228','4eyes_118252','4eyes_118290','4eyes_118291','4eyes_118292','4eyes_118333','4eyes_118352','4eyes_118376','4eyes_118378','4eyes_118381','4eyes_118405','4eyes_118407','4eyes_118461','4eyes_118523','4eyes_118548','4eyes_118659','4eyes_118665','4eyes_118670','4eyes_113053','4eyes_113147','4eyes_113229','4eyes_113280','4eyes_113289','4eyes_113340','4eyes_113381','4eyes_113388','4eyes_113421','4eyes_113435','4eyes_113508','4eyes_113569','4eyes_113619','4eyes_113636','4eyes_113678','4eyes_113700','4eyes_113726','4eyes_113922','4eyes_113964','4eyes_115197','4eyes_115246','4eyes_105204','4eyes_105424','4eyes_105436','4eyes_105521','4eyes_105730','4eyes_105756','4eyes_105810','4eyes_105904','4eyes_105944','4eyes_106016')  AND date >= '2024-04-01' AND date <= '2024-04-08' LIMIT 200000 OFFSET 200000);





SELECT * FROM AUDIENCELAB_INTERNAL_PROD.PUBLIC.UNIVERSAL_PERSON WHERE UP_ID IN (SELECT consumer.up_id FROM four_eyes.public.premade_4eyes_lite pa INNER JOIN AUDIENCELAB_INTERNAL_PROD.PUBLIC.CONSUMER_B2C_FULL consumer ON pa.up_id=consumer.up_id WHERE consumer.id IS NOT NULL AND SEGMENT IN ('4eyes_108584','4eyes_108612','4eyes_108676','4eyes_108844','4eyes_108865','4eyes_108890','4eyes_108897','4eyes_108948','4eyes_108967','4eyes_108981','4eyes_109002','4eyes_109012','4eyes_109027','4eyes_109031','4eyes_109049','4eyes_109056','4eyes_109116','4eyes_109247','4eyes_109304','4eyes_109373','4eyes_109378','4eyes_109501','4eyes_109732','4eyes_109773','4eyes_109904','4eyes_110009','4eyes_110035','4eyes_110158','4eyes_110194','4eyes_110226','4eyes_110405','4eyes_110432','4eyes_110443','4eyes_110456','4eyes_110481','4eyes_110664','4eyes_110792','4eyes_111033','4eyes_111107','4eyes_111360','4eyes_111377','4eyes_111411','4eyes_111437','4eyes_111452','4eyes_111474','4eyes_111477','4eyes_111479','4eyes_111501','4eyes_111513','4eyes_111521','4eyes_111582','4eyes_111587','4eyes_111601','4eyes_111606','4eyes_111616','4eyes_111624','4eyes_111630','4eyes_111639','4eyes_111657','4eyes_111729','4eyes_111761','4eyes_111779','4eyes_111949','4eyes_112126','4eyes_112138','4eyes_112352','4eyes_112395','4eyes_112401','4eyes_112403','4eyes_112418','4eyes_112428','4eyes_112447','4eyes_112466','4eyes_112535','4eyes_112555','4eyes_112566','4eyes_112621','4eyes_112674','4eyes_112685','4eyes_112720','4eyes_112762','4eyes_112763','4eyes_112819','4eyes_112975','4eyes_119760','4eyes_121598','4eyes_121656','4eyes_121675','4eyes_121695','4eyes_121710','4eyes_121729','4eyes_116932','4eyes_117771','4eyes_117773','4eyes_117790','4eyes_117807','4eyes_117819','4eyes_117821','4eyes_117830','4eyes_117837','4eyes_117839','4eyes_117844','4eyes_117872','4eyes_117915','4eyes_117922','4eyes_117925','4eyes_117928','4eyes_117936','4eyes_117943','4eyes_117952','4eyes_117953','4eyes_118009','4eyes_118038','4eyes_118121','4eyes_118125','4eyes_118228','4eyes_118252','4eyes_118290','4eyes_118291','4eyes_118292','4eyes_118333','4eyes_118352','4eyes_118376','4eyes_118378','4eyes_118381','4eyes_118405','4eyes_118407','4eyes_118461','4eyes_118523','4eyes_118548','4eyes_118659','4eyes_118665','4eyes_118670','4eyes_113053','4eyes_113147','4eyes_113229','4eyes_113280','4eyes_113289','4eyes_113340','4eyes_113381','4eyes_113388','4eyes_113421','4eyes_113435','4eyes_113508','4eyes_113569','4eyes_113619','4eyes_113636','4eyes_113678','4eyes_113700','4eyes_113726','4eyes_113922','4eyes_113964','4eyes_115197','4eyes_115246','4eyes_105204','4eyes_105424','4eyes_105436','4eyes_105521','4eyes_105730','4eyes_105756','4eyes_105810','4eyes_105904','4eyes_105944','4eyes_106016')  AND date >= '2024-04-01' AND date <= '2024-04-08' LIMIT 100000 OFFSET 400000);



