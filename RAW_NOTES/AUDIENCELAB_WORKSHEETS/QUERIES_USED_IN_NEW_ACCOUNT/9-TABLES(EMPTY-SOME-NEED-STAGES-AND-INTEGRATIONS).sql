-- This document contains all table creation queries that were used to set up the 
-- new Snowflake Account. The commented-out queries are leftover queries from the 
-- old Snowflake Account, which were replaced by the uncommented queries.


-- AUDIENCELAB_INTERNAL_PROD.PUBLIC.UNIVERSAL_PERSON
CREATE OR REPLACE TABLE AUDIENCELAB_INTERNAL_PROD.PUBLIC.UNIVERSAL_PERSON CLUSTER by (EXACT_AGE)(
	ID NUMBER(38,0),
	FIRST_NAME VARCHAR(16777216),
	LAST_NAME VARCHAR(16777216),
	BUSINESS_EMAIL VARCHAR(16777216),
	SHA256_BUSINESS_EMAIL VARCHAR(16777216),
	PROGRAMMATIC_BUSINESS_EMAILS VARCHAR(16777216),
	MOBILE_PHONE VARCHAR(16777216),
	DIRECT_NUMBER VARCHAR(16777216),
	PERSONAL_PHONE VARCHAR(16777216),
	LINKEDIN_URL VARCHAR(16777216),
	PERSONAL_ADDRESS VARCHAR(16777216),
	PERSONAL_ADDRESS_2 VARCHAR(16777216),
	PERSONAL_CITY VARCHAR(16777216),
	PERSONAL_STATE VARCHAR(16777216),
	PERSONAL_ZIP VARCHAR(16777216),
	PERSONAL_ZIP4 VARCHAR(16777216),
	PERSONAL_EMAIL VARCHAR(16777216),
	SHA256_PERSONAL_EMAIL VARCHAR(16777216),
	ADDITIONAL_PERSONAL_EMAILS VARCHAR(16777216),
	GENDER VARCHAR(16777216),
	AGE_RANGE VARCHAR(16777216),
	MARRIED VARCHAR(16777216),
	CHILDREN VARCHAR(16777216),
	INCOME_RANGE VARCHAR(16777216),
	NET_WORTH VARCHAR(16777216),
	HOMEOWNER VARCHAR(16777216),
	JOB_TITLE VARCHAR(16777216),
	SENIORITY_LEVEL VARCHAR(16777216),
	DEPARTMENT VARCHAR(16777216),
	PROFESSIONAL_ADDRESS VARCHAR(16777216),
	PROFESSIONAL_ADDRESS2 VARCHAR(16777216),
	PROFESSIONAL_CITY VARCHAR(16777216),
	PROFESSIONAL_STATE VARCHAR(16777216),
	PROFESSIONAL_ZIP VARCHAR(16777216),
	PROFESSIONAL_ZIP4 VARCHAR(16777216),
	COMPANY_NAME VARCHAR(16777216),
	COMPANY_DOMAIN VARCHAR(16777216),
	COMPANY_PHONE VARCHAR(16777216),
	COMPANY_SIC VARCHAR(16777216),
	COMPANY_ADDRESS VARCHAR(16777216),
	COMPANY_CITY VARCHAR(16777216),
	COMPANY_STATE VARCHAR(16777216),
	COMPANY_ZIP VARCHAR(16777216),
	COMPANY_LINKEDIN_URL VARCHAR(16777216),
	COMPANY_REVENUE VARCHAR(16777216),
	COMPANY_EMPLOYEE_COUNT VARCHAR(16777216),
	PRIMARY_INDUSTRY VARCHAR(16777216),
	BUSINESS_EMAIL_VALIDATION_STATUS VARCHAR(16777216),
	BUSINES_EMAIL_LAST_SEEN TIMESTAMP_NTZ(9),
	PERSONAL_EMAIL_LAST_SEEN_VALIDATION_STATUS VARCHAR(16777216),
	PERSONAL_EMAIL_LAST_SEEN TIMESTAMP_NTZ(9),
	COMPANY_LAST_UPDATED TIMESTAMP_NTZ(9),
	JOB_TITLE_LAST_UPDATED TIMESTAMP_NTZ(9),
	LAST_UPDATED TIMESTAMP_NTZ(9),
	COMPANY_DESCRIPTIONS VARCHAR(16777216),
	RELATED_DOMAINS VARCHAR(16777216),
	DIRECT_NUMBER_DNC_FLAG VARCHAR(16777216),
	PERSONAL_PHONE_DNC_FLAG VARCHAR(16777216),
	MOBILE_PHONE_DNC_FLAG VARCHAR(16777216),
	COMPANY_PHONE_DNC_FLAG VARCHAR(16777216),
	CREDIT_RATING VARCHAR(16777216),
	EXACT_AGE NUMBER(38,0),
	UP_ID VARCHAR(16777216)
);


-- AUDIENCELAB_INTERNAL_PROD.PUBLIC.CONSUMER_B2C_FULL:
CREATE OR REPLACE TABLE AUDIENCELAB_INTERNAL_PROD.PUBLIC.CONSUMER_B2C_FULL CLUSTER by (EXACT_AGE)(
	ID NUMBER(38,0),
	FIRST_NAME VARCHAR(16777216),
	LAST_NAME VARCHAR(16777216),
	PERSONAL_EMAIL VARCHAR(16777216),
	SHA256_PERSONAL_EMAIL VARCHAR(16777216),
	ADDITIONAL_PERSONAL_EMAILS VARCHAR(16777216),
	ADDRESS VARCHAR(16777216),
	ADDRESS_2 VARCHAR(16777216),
	LATITUDE VARCHAR(16777216),
	LONGITUDE VARCHAR(16777216),
	MOBILE_PHONE VARCHAR(16777216),
	PERSONAL_PHONE VARCHAR(16777216),
	DPV_CODE VARCHAR(16777216),
	GENDER VARCHAR(16777216),
	AGE_RANGE VARCHAR(16777216),
	MARRIED VARCHAR(16777216),
	CHILDREN VARCHAR(16777216),
	INCOME_RANGE VARCHAR(16777216),
	NET_WORTH VARCHAR(16777216),
	HOME_OWNER VARCHAR(16777216),
	PERSONAL_EMAIL_LAST_SEEN_VALIDATION_STATUS VARCHAR(16777216),
	PERSONAL_EMAIL_LAST_SEEN TIMESTAMP_NTZ(9),
	CONSUMER_ADDRESS VARCHAR(16777216),
	ADULTS_F_18_24 VARCHAR(16777216),
	ADULTS_F_25_34 VARCHAR(16777216),
	ADULTS_F_35_44 VARCHAR(16777216),
	ADULTS_F_45_54 VARCHAR(16777216),
	ADULTS_F_55_64 VARCHAR(16777216),
	ADULTS_F_65_74 VARCHAR(16777216),
	ADULTS_F_75PLUS VARCHAR(16777216),
	ADULTS_M_18_24 VARCHAR(16777216),
	ADULTS_M_25_34 VARCHAR(16777216),
	ADULTS_M_35_44 VARCHAR(16777216),
	ADULTS_M_45_54 VARCHAR(16777216),
	ADULTS_M_55_64 VARCHAR(16777216),
	ADULTS_M_65_74 VARCHAR(16777216),
	ADULTS_M_75PLUS VARCHAR(16777216),
	ADULTS_U_18_24 VARCHAR(16777216),
	ADULTS_U_25_34 VARCHAR(16777216),
	ADULTS_U_35_44 VARCHAR(16777216),
	ADULTS_U_45_54 VARCHAR(16777216),
	ADULTS_U_55_64 VARCHAR(16777216),
	ADULTS_U_65_74 VARCHAR(16777216),
	ADULTS_U_75PLUS VARCHAR(16777216),
	AUTO_BODY_TYPE VARCHAR(16777216),
	AUTO_DEF_ENGINE_CYLINDERS VARCHAR(16777216),
	AUTO_DEF_TRANS_TYPE VARCHAR(16777216),
	AUTO_FUEL_TYPE VARCHAR(16777216),
	AUTO_GVW_RANGE VARCHAR(16777216),
	AUTO_MAKE VARCHAR(16777216),
	AUTO_MFG_CODE VARCHAR(16777216),
	AUTO_MSRP NUMBER(38,0),
	AUTO_STYLE VARCHAR(16777216),
	AUTO_VEHICLE_TYPE VARCHAR(16777216),
	AUTO_VIN_ VARCHAR(16777216),
	AUTO_YEAR_ VARCHAR(16777216),
	AUTOALARMTYPE VARCHAR(16777216),
	AUTOANNUALMILES VARCHAR(16777216),
	AUTOCOMMUTEDISTANCE VARCHAR(16777216),
	AUTOHASABS VARCHAR(16777216),
	AUTOHASAIRBAGS VARCHAR(16777216),
	AUTOINSBODILYINJURYCOVERAGE VARCHAR(16777216),
	AUTOINSCOLLISIONDEDUCTIBLE VARCHAR(16777216),
	AUTOINSCOMPREHENSIVEDEDUCTIBLE VARCHAR(16777216),
	AUTOINSCOVERAGETYPE VARCHAR(16777216),
	AUTOINSCOVERAGETYPEREQUESTED VARCHAR(16777216),
	AUTOINSPROPERTYDAMAGECOVERAGE VARCHAR(16777216),
	AUTOMAKE VARCHAR(16777216),
	AUTOPRIMARYUSE VARCHAR(16777216),
	AUTOYEAR VARCHAR(16777216),
	CC_AMEX_PREM VARCHAR(16777216),
	CC_AMEX_REG VARCHAR(16777216),
	CC_BANK_CD_IN_HH VARCHAR(16777216),
	CC_DISC_PREM VARCHAR(16777216),
	CC_DISC_REG VARCHAR(16777216),
	CC_GAS_PREM VARCHAR(16777216),
	CC_GAS_REG VARCHAR(16777216),
	CC_HLDR_BANK VARCHAR(16777216),
	CC_HLDR_GAS VARCHAR(16777216),
	CC_HLDR_PREM VARCHAR(16777216),
	CC_HLDR_TE VARCHAR(16777216),
	CC_HLDR_UNK VARCHAR(16777216),
	CC_HLDR_UPS_DEPT VARCHAR(16777216),
	CC_MC_PREM VARCHAR(16777216),
	CC_MC_REG VARCHAR(16777216),
	CC_NEW_ISSUE VARCHAR(16777216),
	CC_USER VARCHAR(16777216),
	CC_VISA_PREM VARCHAR(16777216),
	CC_VISA_REG VARCHAR(16777216),
	CENSUS_BLOCK_GROUP VARCHAR(16777216),
	CENSUS_TRACT VARCHAR(16777216),
	CITY VARCHAR(16777216),
	CREDIT_LINES VARCHAR(16777216),
	CREDIT_RANGE_NEW VARCHAR(16777216),
	CREDIT_RATING VARCHAR(16777216),
	DOB_DAY VARCHAR(16777216),
	DOB_MON VARCHAR(16777216),
	DOB_YR VARCHAR(16777216),
	DOMAIN VARCHAR(16777216),
	DONR_ANIMAL VARCHAR(16777216),
	DONR_ARTS VARCHAR(16777216),
	DONR_CHARITABLE VARCHAR(16777216),
	DONR_COMM_CHAR VARCHAR(16777216),
	DONR_ENVIRON VARCHAR(16777216),
	DONR_HEALTH VARCHAR(16777216),
	DONR_INTL_AID VARCHAR(16777216),
	DONR_KIDS VARCHAR(16777216),
	DONR_MAIL_ORD VARCHAR(16777216),
	DONR_OTH VARCHAR(16777216),
	DONR_POL VARCHAR(16777216),
	DONR_POL_CONS VARCHAR(16777216),
	DONR_POL_LIB VARCHAR(16777216),
	DONR_RELIG VARCHAR(16777216),
	DONR_VETS VARCHAR(16777216),
	DONR_WILDLIFE VARCHAR(16777216),
	DRIVERSLICENSEEVERREVOKED VARCHAR(16777216),
	DRIVERSLICENSESTATE VARCHAR(16777216),
	DWELL_TYPE VARCHAR(16777216),
	EDUCATION_LEVEL VARCHAR(16777216),
	ETHNIC_ASSIM VARCHAR(16777216),
	ETHNIC_CONF VARCHAR(16777216),
	ETHNIC_GRP VARCHAR(16777216),
	ETHNIC_HISP_CNTRY VARCHAR(16777216),
	ETHNIC_LANG VARCHAR(16777216),
	ETHNIC_RELIG VARCHAR(16777216),
	EXACT_AGE NUMBER(38,0),
	FIPS_STATE_CODE VARCHAR(16777216),
	GENERATIONS VARCHAR(16777216),
	GENL_PP_HOME_VALUE NUMBER(38,0),
	HH_INCOME VARCHAR(16777216),
	HH_MARITAL_STATUS VARCHAR(16777216),
	INVEST_ACT VARCHAR(16777216),
	INVEST_FOREIGN VARCHAR(16777216),
	INVEST_MONEY_SEEKR VARCHAR(16777216),
	INVEST_PERS VARCHAR(16777216),
	INVEST_READ_FIN_NEWS VARCHAR(16777216),
	INVEST_RL_EST VARCHAR(16777216),
	INVEST_STOCKS VARCHAR(16777216),
	KIDS_F_0_2 VARCHAR(16777216),
	KIDS_F_11_15 VARCHAR(16777216),
	KIDS_F_16_17 VARCHAR(16777216),
	KIDS_F_3_5 VARCHAR(16777216),
	KIDS_F_6_10 VARCHAR(16777216),
	KIDS_M_0_2 VARCHAR(16777216),
	KIDS_M_11_15 VARCHAR(16777216),
	KIDS_M_16_17 VARCHAR(16777216),
	KIDS_M_3_5 VARCHAR(16777216),
	KIDS_M_6_10 VARCHAR(16777216),
	KIDS_U_0_2 VARCHAR(16777216),
	KIDS_U_11_15 VARCHAR(16777216),
	KIDS_U_16_17 VARCHAR(16777216),
	KIDS_U_3_5 VARCHAR(16777216),
	KIDS_U_6_10 VARCHAR(16777216),
	LENGTH_OF_RESIDENCE NUMBER(38,0),
	MAGS VARCHAR(16777216),
	MOTORCYCLE_DATE TIMESTAMP_NTZ(9),
	MOTORCYCLE_MODEL VARCHAR(16777216),
	MOTORCYCLE_VIN VARCHAR(16777216),
	MR_LENDR_CD VARCHAR(16777216),
	MR_LOAN_TYP VARCHAR(16777216),
	MR2_AMT VARCHAR(16777216),
	MR2_LENDR VARCHAR(16777216),
	MR2_LENDR_CD VARCHAR(16777216),
	MR2_LOAN_TYP VARCHAR(16777216),
	MR2_RATE_TYP VARCHAR(16777216),
	NAME_SUFFIX VARCHAR(16777216),
	NUM_ADULTS VARCHAR(16777216),
	NUM_KIDS VARCHAR(16777216),
	OCC_AFRIC_AMER_PROF VARCHAR(16777216),
	OCC_BUSN_OWNR VARCHAR(16777216),
	OCC_HOME_OFF VARCHAR(16777216),
	OCC_SOHO_IND VARCHAR(16777216),
	OCC_WORKING_WMN VARCHAR(16777216),
	OPTIN_DATE TIMESTAMP_NTZ(9),
	P2_AMT VARCHAR(16777216),
	P2_LOAN_TYP VARCHAR(16777216),
	P2_RATE_TYP VARCHAR(16777216),
	PARTY_AFFILIATION VARCHAR(16777216),
	PAYDAY_EMPLOYER_NAME VARCHAR(16777216),
	PAYDAY_EMPLOYMENT_STATUS VARCHAR(16777216),
	PAYDAY_FLAG VARCHAR(16777216),
	PAYDAY_LOAN_REQUESTED_AMT VARCHAR(16777216),
	PAYDAY_MILITARY_FLAG VARCHAR(16777216),
	PAYDAY_OCCUPATION VARCHAR(16777216),
	PRES_KIDS VARCHAR(16777216),
	PROP_AC VARCHAR(16777216),
	PROP_FUEL VARCHAR(16777216),
	PROP_POOL VARCHAR(16777216),
	PROP_SEWER VARCHAR(16777216),
	PROP_TYPE VARCHAR(16777216),
	PROP_WATER VARCHAR(16777216),
	SINGLE_PARENT VARCHAR(16777216),
	SR_ADULT_IN_HH VARCHAR(16777216),
	STATE VARCHAR(16777216),
	URL VARCHAR(16777216),
	VET_IN_HH VARCHAR(16777216),
	WALK_SEQUENCE_CODE VARCHAR(16777216),
	YOUNG_ADULT_IN_HH VARCHAR(16777216),
	ZIP VARCHAR(16777216),
	ZIP4 VARCHAR(16777216),
	PERSONAL_PHONE_DNC_FLAG VARCHAR(16777216),
	MOBILE_PHONE_DNC_FLAG VARCHAR(16777216),
	UP_ID VARCHAR(16777216)
);


-- AUDIENCELAB_INTERNAL_PROD.PUBLIC.B2B_EXPORT_TROVO:
CREATE OR REPLACE TABLE AUDIENCELAB_INTERNAL_PROD.PUBLIC.B2B_EXPORT_TROVO (
	ID NUMBER(38,0),
	FIRST_NAME VARCHAR(16777216),
	LAST_NAME VARCHAR(16777216),
	BUSINESS_EMAIL VARCHAR(16777216),
	SHA256_BUSINESS_EMAIL VARCHAR(16777216),
	PROGRAMMATIC_BUSINESS_EMAILS VARCHAR(16777216),
	PERSONAL_EMAIL VARCHAR(16777216),
	SHA256_PERSONAL_EMAIL VARCHAR(16777216),
	JOB_TITLE VARCHAR(16777216),
	SENIORITY_LEVEL VARCHAR(16777216),
	DEPARTMENT VARCHAR(16777216),
	MOBILE_PHONE VARCHAR(16777216),
	DIRECT_NUMBER VARCHAR(16777216),
	LINKEDIN_URL VARCHAR(16777216),
	PERSONAL_ADDRESS VARCHAR(16777216),
	PERSONAL_ADDRESS_2 VARCHAR(16777216),
	PERSONAL_CITY VARCHAR(16777216),
	PERSONAL_STATE VARCHAR(16777216),
	PERSONAL_ZIP VARCHAR(16777216),
	PERSONAL_ZIP4 VARCHAR(16777216),
	PROFESSIONAL_ADDRESS VARCHAR(16777216),
	PROFESSIONAL_ADDRESS_2 VARCHAR(16777216),
	PROFESSIONAL_CITY VARCHAR(16777216),
	PROFESSIONAL_STATE VARCHAR(16777216),
	PROFESSIONAL_ZIP VARCHAR(16777216),
	PROFESSIONAL_ZIP4 VARCHAR(16777216),
	COMPANY_NAME VARCHAR(16777216),
	COMPANY_DOMAIN VARCHAR(16777216),
	COMPANY_PHONE VARCHAR(16777216),
	PRIMARY_INDUSTRY VARCHAR(16777216),
	COMPANY_SIC VARCHAR(16777216),
	COMPANY_NAICS VARCHAR(16777216),
	COMPANY_ADDRESS VARCHAR(16777216),
	COMPANY_ADDRESS_2 VARCHAR(16777216),
	COMPANY_CITY VARCHAR(16777216),
	COMPANY_STATE VARCHAR(16777216),
	COMPANY_ZIP VARCHAR(16777216),
	COMPANY_ZIP4 VARCHAR(16777216),
	COMPANY_LINKEDIN_URL VARCHAR(16777216),
	COMPANY_REVENUE VARCHAR(16777216),
	COMPANY_EMPLOYEE_COUNT VARCHAR(16777216),
	BUSINESS_EMAIL_VALIDATION_STATUS VARCHAR(16777216),
	BUSINESS_EMAIL_LAST_SEEN TIMESTAMP_NTZ(9),
	COMPANY_LAST_UPDATED TIMESTAMP_NTZ(9),
	JOB_TITLE_LAST_UPDATED TIMESTAMP_NTZ(9),
	LAST_UPDATED TIMESTAMP_NTZ(9)
);

-- AUDIENCELAB_INTERNAL_PROD.PUBLIC.KEYWORD_PLANNER
CREATE OR REPLACE TABLE AUDIENCELAB_INTERNAL_PROD.PUBLIC.KEYWORD_PLANNER (
	UTC_DATE DATE,
	KEYWORD VARCHAR(16777216),
	COUNT NUMBER(38,0)
);

-- AUDIENCELAB_INTERNAL_PROD.PUBLIC.TROVO_FEED_RESOLVED
CREATE OR REPLACE TABLE AUDIENCELAB_INTERNAL_PROD.PUBLIC.TROVO_FEED_RESOLVED (
	TROVO_ID VARCHAR(16777216),
	PARTNER_ID VARCHAR(16777216),
	PARTNER_UID VARCHAR(16777216),
	SHA256_LOWER_CASE VARCHAR(16777216),
	IP VARCHAR(16777216),
	EVENT_DATE TIMESTAMP_NTZ(9),
	INGESTION_TIMESTAMP TIMESTAMP_NTZ(9)
);


-- AUDIENCELAB_INTERNAL_PROD.PUBLIC.ST_CONSUMER:
--     CREATE OR REPLACE TABLE AUDIENCELAB_INTERNAL_PROD.PUBLIC.ST_CONSUMER CLUSTER BY (UTC_DATE)(
-- 	UTC_DATE DATE,
-- 	KEYWORD VARCHAR(16777216),
-- 	INDIVIDUALID ARRAY
-- );

-- AUDIENCELAB_INTERNAL_PROD.PUBLIC.KEYWORD_PLANNER Materialized View:
-- CREATE OR REPLACE MATERIALIZED VIEW AUDIENCELAB_INTERNAL_PROD.PUBLIC.KEYWORD_PLANNER(
-- 	UTC_DATE,
-- 	KEYWORD,
-- 	COUNT
-- ) CLUSTER BY (utc_date) as (
--     SELECT utc_date, keyword, ARRAY_SIZE(individualid) count FROM public.st_consumer
-- );

-- AUDIENCELAB_INTERNAL_PROD.PUBLIC.PREMADE_TAXONOMY:
-- CREATE OR REPLACE TABLE AUDIENCELAB_INTERNAL_PROD.PUBLIC.PREMADE_TAXONOMY (
-- 	ID VARCHAR(16777216),
-- 	NAME VARCHAR(16777216)
-- );

-- AUDIENCELAB_INTERNAL_PROD.PUBLIC.TROVO_FEED_RESOLVED (External Table, needs @AUDIENCELAB_INTERNAL_PROD.RAW_DATA.TROVO_ADSLAB_STAGE stage with this URL: s3://trovo-coop-adslab/outgoing/cookie_sync/resolved/):
--   CREATE OR REPLACE EXTERNAL TABLE AUDIENCELAB_INTERNAL_PROD.RAW_DATA.TROVO_FEED_RESOLVED 
--     (
--     TROVO_ID VARCHAR(16777216) AS (CAST(GET(VALUE, 'TROVO_ID') AS VARCHAR(16777216))), 
--     PARTNER_ID VARCHAR(16777216) AS (CAST(GET(VALUE, 'PARTNER_ID') AS VARCHAR(16777216))),
--     PARTNER_UID VARCHAR(16777216) AS (CAST(GET(VALUE, 'PARTNER_UID') AS VARCHAR(16777216))), 
--     SHA256_LOWER_CASE VARCHAR(16777216) AS (CAST(GET(VALUE, 'SHA256_LOWER_CASE') AS VARCHAR(16777216))), 
--     IP VARCHAR(16777216) AS (CAST(GET(VALUE, 'IP') AS VARCHAR(16777216))), 
--     JSON_HEADERS VARCHAR(16777216) AS (CAST(GET(VALUE, 'JSON_HEADERS') AS VARCHAR(16777216))), 
--     EVENT_DATE TIMESTAMP_NTZ(9) AS (CAST(GET(VALUE, 'EVENT_DATE') AS TIMESTAMP_NTZ(9))), 
--     INGESTION_TIMESTAMP TIMESTAMP_NTZ(9) AS (CAST(CONCAT(SUBSTR(METADATA$FILENAME, 33, 4), '-', SUBSTR(METADATA$FILENAME, 40, 2), '-', SUBSTR(METADATA$FILENAME, 45, 2), ' ', SUBSTR(METADATA$FILENAME, 50, 2), ':', SUBSTR(METADATA$FILENAME, 55, 2), ':0', SUBSTR(METADATA$FILENAME, 58, 1)) AS TIMESTAMP_NTZ(9))))
--     LOCATION=@TROVO_ADSLAB_STAGE/cookie_sync/resolved/ 
--     pattern='.*.parquet' 
--     file_format=(TYPE=PARQUET NULL_IF=());



-- FOUR_EYES.PUBLIC.SHA_TO_UPS:
    CREATE OR REPLACE TRANSIENT TABLE FOUR_EYES.PUBLIC.SHA_TO_UPS (
	SHA256_LC_HEM VARCHAR(16777216),
	UP_IDS ARRAY
);

-- FOUR_EYES.PUBLIC.RAW_TOPICS:
    CREATE OR REPLACE TRANSIENT TABLE FOUR_EYES.PUBLIC.RAW_TOPICS (
	SHA256_LC_HEM VARCHAR(16777216),
	TOPIC VARCHAR(16777216),
	DATE DATE
);


-- FOUR_EYES.PUBLIC.PREMADE_4EYES_LITE:
    CREATE OR REPLACE TRANSIENT TABLE FOUR_EYES.PUBLIC.PREMADE_4EYES_LITE (
    DATE DATE,
	SEGMENT VARCHAR(16777216),
	UP_ID VARCHAR(16777216)
    );



    SELECT * FROM FOUR_EYES.PUBLIC.PREMADE_4EYES_LITE LIMIT 10000;




    COPY INTO FOUR_EYES.PUBLIC.PREMADE_4EYES_LITE
    FROM (
    SELECT
    TO_DATE(T.$1) AS DATE,
    REPLACE(T.$2, '"', '') AS SEGMENT,
    T.$3 AS UP_ID
    FROM @FOUR_EYES.PUBLIC.AUDIENCELAB_BACKUP_STAGE/premade_4eyes_lite AS T
    );





    

